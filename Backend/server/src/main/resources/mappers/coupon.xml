<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.cafe.model.dao.CouponDao">

    <resultMap id="CouponResultMap" type="Coupon">
        <result column="iat_date" property="iat" javaType="java.time.LocalDateTime"/>
        <result column="exp_date" property="exp" javaType="java.time.LocalDateTime"/>
        <result column="user_id" property="userId"/>
        <result column="name" property="name"/>
        <result column="description" property="description"/>
        <result column="image" property="image"/>
        <result column="menu_id" property="menuId"/>
        <result column="menu_count" property="menuCount"/>
        <result column="id" property="id"/>
    </resultMap>
    
    <select id="getCoupons" parameterType="string" resultMap="CouponResultMap">
        SELECT *
        FROM t_coupon
        WHERE user_id = #{userId}
        ORDER BY exp_date DESC
    </select>

    <insert id="setInitCoupon" parameterType="Coupon">
        INSERT INTO t_coupon (user_id, name, description, image, menu_id, menu_count)
        VALUES (#{userId}, #{name}, #{description}, #{image}, #{menuId}, #{menuCount})
    </insert>

    <delete id="deleteCoupon" parameterType="int">
        delete from t_coupon 
        where id = #{couponId}
    </delete>
    
</mapper>